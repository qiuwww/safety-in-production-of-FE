# xxx 项目开发详细文档

## 版本

| **作者** | **修改日期** | **版本** |
| -------- | ------------ | -------- |
| XXX      | 2021.5.6     | 2.2.1    |

## 需求背景

为尽快达成小程序内的服务流程闭环，快速响应拉新策略、完成转化目标——100w 日活此版本主要用于邀请有礼优化、内容体系建设 1.0 兼容、首页 banner 分享优化、药店渠道用户屏蔽交易降低风险。

## 需求目标

各公众号用户&其他前端业务用户。

## 相关资源

prd 地址：[https://92jkys.yuque.com/docs/share/204769ef-ee64-4576-83b9-cfabed309726?#%EF%BC%88%E5%AF%86%E7%A0%81%EF%BC%9Akig4%EF%BC%89](https://92jkys.yuque.com/docs/share/204769ef-ee64-4576-83b9-cfabed309726?#%EF%BC%88%E5%AF%86%E7%A0%81%EF%BC%9Akig4%EF%BC%89)

## 工作量细化

例如药店问诊 C 端用户扫码关注银川问诊公众号后续通过推送智云健康小程序提供服务支撑、城市合伙人会员为快速实现引流&拉新&转化提供小程序二维码快速体验相关权益&服务。

| **功能点** | **计划时间（人/日）** | **备注** |
| --- | --- | --- |
| 1. 首页 banner 优化 | 1 | 1、小程序首页 banner 分享优化，支持详情页分享，分享文案及标题取 banner； 2、支持根据按渠道参数个性化配置小程序 banner |
| 2. 会员分享优化 | 0.2 | 【我的—兑换会员】页面支持分享，分享 title 均为：智云健康会员，邀您享受更多 VIP 服务图片：智云会员图片 |
| 3. 针对药店渠道参数的商品/药品交易场景屏蔽； | 1 | 1、问诊处方购药入口：快速问诊、专家问诊、会员问诊 2、商城模块入口屏蔽：会员权益页等 3、个人中心优惠券屏蔽商城入口 ——点击对应按钮提示下载智云健康 app |
| 4. 邀请有礼授权登录优化&商城授权登陆优化（卡尔搭建页） | 2（这部分 kaer 相关的是 XX 来写，剩余商城部分 0.5） | 1、支持卡尔搭建的活动页根据组件以及页面配置的是否登陆规则，触发登陆，登陆完成后支持停留在当前页面（而非小程序首页） |
| 5. 医生主页智云号&健康百科重构 | 0（XX 来适配） | 1、支持医生主页展示对应智云号内容、健康百科详情页重构 2、小程序分享文章详情页分享标题取文章标题，分享图片取文章头图 |

## 功能点细分

### 1. 整体功能 时序图/流程图

暂不需要

### 2. 相关功能拆解

1. 主要要关注当**前打开的渠道**；
   1. 这里需要从当前打开小程序的渠道参数，来判断当前渠道是不是在 dms 配置的渠道，如果是的就不允许打开相应的商城的操作（因为从药店引流的问题）；
2. 医生主页智云号&健康百科；
   1. 这部分主要是医生主页会展示医生的文章，且文章需要分享出去，分享的行为及参数需要配置，这部分工作主要是于水增来完成，当前主要协助这部分的开发；
3. 邀请有礼授权登录优化&商城授权登陆优化（卡尔搭建页）
   1. 卡尔搭建模版数据库升级：kaer 系统相关开发来完成；
   1. 小程序支持卡尔搭建页授权登陆（培英），需要判断卡尔页面，且在需要登陆的时候跳转到小程序的登陆，登陆成功再跳转回目标页面；
   1. 商城开放更多资源位：这个问题 2.2.0 已完成部分，后续更多的需要后端支持相应页面开放接口访问控制；
   1. 小程序个人中心页-优惠券：
      1. 开发分支：zmall/qatest-mp-2.2.1
      1. 需要修改商城里边的入口判断，从 url 和 adapt 判断当前的环境，然后弹出提示信息，终止后续操作；
   1. 小程序个人中心页-订单：
      1. 开发分支：zmall/qatest-mp-2.2.1
      1. 操作同优惠券，这里的参数需要逐级向后传递，避免存在本地，影响别的位置；
4. 首页 banner 配置&分享优化：
   1. 这里主要区分 banner 的跳转类型是小程序还是 h5，如果是 h5 需要区分一下跳转的渠道参数；
   1. 分享的参数需要通过 url 传递到页面内。
   1. 需要后端修改接口，传入渠道参数；
   1. 后台 admin 要配合修改；
   1. 获取的时候接口也要修改；
5. 会员中心-商城折扣权益入口屏蔽：
   1. 传入参数，然后点击的地方屏蔽；
